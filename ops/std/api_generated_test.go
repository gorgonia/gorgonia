package stdops

import (
	"testing"

	"github.com/stretchr/testify/assert"
	"gorgonia.org/gorgonia/ops"
	"gorgonia.org/tensor"
	"gorgonia.org/tensor/dense"
)

// Code generated by genops, which is a ops generation tool for Gorgonia. DO NOT EDIT.

func TestAdd(t *testing.T) {
	assert := assert.New(t)

	var op, expected ops.Op[float64, *dense.Dense[float64]]

	// test vv
	a := dense.New[float64](tensor.WithShape(2, 3))
	b := dense.New[float64](tensor.WithShape(2, 3))
	op = Add[float64, *dense.Dense[float64]](a, b)
	expected = addVV[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

	// test vs
	b = dense.New[float64](tensor.WithShape())
	op = Add[float64, *dense.Dense[float64]](a, b)
	expected = addVS[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

	// test sv
	op = Add[float64, *dense.Dense[float64]](b, a)
	expected = addSV[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

	// test ss
	a = dense.New[float64](tensor.WithShape())
	op = Add[float64, *dense.Dense[float64]](a, b)
	expected = addVV[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

}

func TestSub(t *testing.T) {
	assert := assert.New(t)

	var op, expected ops.Op[float64, *dense.Dense[float64]]

	// test vv
	a := dense.New[float64](tensor.WithShape(2, 3))
	b := dense.New[float64](tensor.WithShape(2, 3))
	op = Sub[float64, *dense.Dense[float64]](a, b)
	expected = subVV[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

	// test vs
	b = dense.New[float64](tensor.WithShape())
	op = Sub[float64, *dense.Dense[float64]](a, b)
	expected = subVS[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

	// test sv
	op = Sub[float64, *dense.Dense[float64]](b, a)
	expected = subSV[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

	// test ss
	a = dense.New[float64](tensor.WithShape())
	op = Sub[float64, *dense.Dense[float64]](a, b)
	expected = subVV[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

}

func TestMul(t *testing.T) {
	assert := assert.New(t)

	var op, expected ops.Op[float64, *dense.Dense[float64]]

	// test vv
	a := dense.New[float64](tensor.WithShape(2, 3))
	b := dense.New[float64](tensor.WithShape(2, 3))
	op = Mul[float64, *dense.Dense[float64]](a, b)
	expected = mulVV[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

	// test vs
	b = dense.New[float64](tensor.WithShape())
	op = Mul[float64, *dense.Dense[float64]](a, b)
	expected = mulVS[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

	// test sv
	op = Mul[float64, *dense.Dense[float64]](b, a)
	expected = mulSV[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

	// test ss
	a = dense.New[float64](tensor.WithShape())
	op = Mul[float64, *dense.Dense[float64]](a, b)
	expected = mulVV[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

}

func TestDiv(t *testing.T) {
	assert := assert.New(t)

	var op, expected ops.Op[float64, *dense.Dense[float64]]

	// test vv
	a := dense.New[float64](tensor.WithShape(2, 3))
	b := dense.New[float64](tensor.WithShape(2, 3))
	op = Div[float64, *dense.Dense[float64]](a, b)
	expected = divVV[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

	// test vs
	b = dense.New[float64](tensor.WithShape())
	op = Div[float64, *dense.Dense[float64]](a, b)
	expected = divVS[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

	// test sv
	op = Div[float64, *dense.Dense[float64]](b, a)
	expected = divSV[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

	// test ss
	a = dense.New[float64](tensor.WithShape())
	op = Div[float64, *dense.Dense[float64]](a, b)
	expected = divVV[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

}

func TestPow(t *testing.T) {
	assert := assert.New(t)

	var op, expected ops.Op[float64, *dense.Dense[float64]]

	// test vv
	a := dense.New[float64](tensor.WithShape(2, 3))
	b := dense.New[float64](tensor.WithShape(2, 3))
	op = Pow[float64, *dense.Dense[float64]](a, b)
	expected = powVV[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

	// test vs
	b = dense.New[float64](tensor.WithShape())
	op = Pow[float64, *dense.Dense[float64]](a, b)
	expected = powVS[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

	// test sv
	op = Pow[float64, *dense.Dense[float64]](b, a)
	expected = powSV[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

	// test ss
	a = dense.New[float64](tensor.WithShape())
	op = Pow[float64, *dense.Dense[float64]](a, b)
	expected = powVV[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

}

func TestMod(t *testing.T) {
	assert := assert.New(t)

	var op, expected ops.Op[float64, *dense.Dense[float64]]

	// test vv
	a := dense.New[float64](tensor.WithShape(2, 3))
	b := dense.New[float64](tensor.WithShape(2, 3))
	op = Mod[float64, *dense.Dense[float64]](a, b)
	expected = modVV[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

	// test vs
	b = dense.New[float64](tensor.WithShape())
	op = Mod[float64, *dense.Dense[float64]](a, b)
	expected = modVS[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

	// test sv
	op = Mod[float64, *dense.Dense[float64]](b, a)
	expected = modSV[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

	// test ss
	a = dense.New[float64](tensor.WithShape())
	op = Mod[float64, *dense.Dense[float64]](a, b)
	expected = modVV[float64, *dense.Dense[float64]]{}
	assert.Equal(op, expected)

}

func TestLt(t *testing.T) {
	assert := assert.New(t)

	var op, expected ops.Op[float64, *dense.Dense[float64]]

	// test vv
	a := dense.New[float64](tensor.WithShape(2, 3))
	b := dense.New[float64](tensor.WithShape(2, 3))
	op = Lt[float64, *dense.Dense[float64]](a, b, false)
	expected = ltVV[float64, *dense.Dense[float64]]{ltOp[float64, *dense.Dense[float64]]{retSame: false}, binopVV{}}
	assert.Equal(op, expected)

	// test vv but retSame = true
	op = Lt[float64, *dense.Dense[float64]](a, b, true)
	expected = ltVV[float64, *dense.Dense[float64]]{ltOp[float64, *dense.Dense[float64]]{retSame: true}, binopVV{}}
	assert.Equal(op, expected)

	// test vs
	b = dense.New[float64](tensor.WithShape())
	op = Lt[float64, *dense.Dense[float64]](a, b, false)
	expected = ltVS[float64, *dense.Dense[float64]]{ltOp[float64, *dense.Dense[float64]]{retSame: false}, binopVS{}}
	assert.Equal(op, expected)

	// test vs but retSame = true
	op = Lt[float64, *dense.Dense[float64]](a, b, true)
	expected = ltVS[float64, *dense.Dense[float64]]{ltOp[float64, *dense.Dense[float64]]{retSame: true}, binopVS{}}
	assert.Equal(op, expected)

	// test sv
	op = Lt[float64, *dense.Dense[float64]](b, a, false)
	expected = ltSV[float64, *dense.Dense[float64]]{ltOp[float64, *dense.Dense[float64]]{retSame: false}, binopSV{}}
	assert.Equal(op, expected)

	// test sv but retSame = true
	op = Lt[float64, *dense.Dense[float64]](b, a, true)
	expected = ltSV[float64, *dense.Dense[float64]]{ltOp[float64, *dense.Dense[float64]]{retSame: true}, binopSV{}}
	assert.Equal(op, expected)

	// test ss
	a = dense.New[float64](tensor.WithShape())
	op = Lt[float64, *dense.Dense[float64]](a, b, false)
	expected = ltVV[float64, *dense.Dense[float64]]{ltOp[float64, *dense.Dense[float64]]{retSame: false}, binopVV{}}
	assert.Equal(op, expected)

	// test ss but retSame = true
	op = Lt[float64, *dense.Dense[float64]](a, b, true)
	expected = ltVV[float64, *dense.Dense[float64]]{ltOp[float64, *dense.Dense[float64]]{retSame: true}, binopVV{}}
	assert.Equal(op, expected)

}

func TestLte(t *testing.T) {
	assert := assert.New(t)

	var op, expected ops.Op[float64, *dense.Dense[float64]]

	// test vv
	a := dense.New[float64](tensor.WithShape(2, 3))
	b := dense.New[float64](tensor.WithShape(2, 3))
	op = Lte[float64, *dense.Dense[float64]](a, b, false)
	expected = lteVV[float64, *dense.Dense[float64]]{lteOp[float64, *dense.Dense[float64]]{retSame: false}, binopVV{}}
	assert.Equal(op, expected)

	// test vv but retSame = true
	op = Lte[float64, *dense.Dense[float64]](a, b, true)
	expected = lteVV[float64, *dense.Dense[float64]]{lteOp[float64, *dense.Dense[float64]]{retSame: true}, binopVV{}}
	assert.Equal(op, expected)

	// test vs
	b = dense.New[float64](tensor.WithShape())
	op = Lte[float64, *dense.Dense[float64]](a, b, false)
	expected = lteVS[float64, *dense.Dense[float64]]{lteOp[float64, *dense.Dense[float64]]{retSame: false}, binopVS{}}
	assert.Equal(op, expected)

	// test vs but retSame = true
	op = Lte[float64, *dense.Dense[float64]](a, b, true)
	expected = lteVS[float64, *dense.Dense[float64]]{lteOp[float64, *dense.Dense[float64]]{retSame: true}, binopVS{}}
	assert.Equal(op, expected)

	// test sv
	op = Lte[float64, *dense.Dense[float64]](b, a, false)
	expected = lteSV[float64, *dense.Dense[float64]]{lteOp[float64, *dense.Dense[float64]]{retSame: false}, binopSV{}}
	assert.Equal(op, expected)

	// test sv but retSame = true
	op = Lte[float64, *dense.Dense[float64]](b, a, true)
	expected = lteSV[float64, *dense.Dense[float64]]{lteOp[float64, *dense.Dense[float64]]{retSame: true}, binopSV{}}
	assert.Equal(op, expected)

	// test ss
	a = dense.New[float64](tensor.WithShape())
	op = Lte[float64, *dense.Dense[float64]](a, b, false)
	expected = lteVV[float64, *dense.Dense[float64]]{lteOp[float64, *dense.Dense[float64]]{retSame: false}, binopVV{}}
	assert.Equal(op, expected)

	// test ss but retSame = true
	op = Lte[float64, *dense.Dense[float64]](a, b, true)
	expected = lteVV[float64, *dense.Dense[float64]]{lteOp[float64, *dense.Dense[float64]]{retSame: true}, binopVV{}}
	assert.Equal(op, expected)

}

func TestGt(t *testing.T) {
	assert := assert.New(t)

	var op, expected ops.Op[float64, *dense.Dense[float64]]

	// test vv
	a := dense.New[float64](tensor.WithShape(2, 3))
	b := dense.New[float64](tensor.WithShape(2, 3))
	op = Gt[float64, *dense.Dense[float64]](a, b, false)
	expected = gtVV[float64, *dense.Dense[float64]]{gtOp[float64, *dense.Dense[float64]]{retSame: false}, binopVV{}}
	assert.Equal(op, expected)

	// test vv but retSame = true
	op = Gt[float64, *dense.Dense[float64]](a, b, true)
	expected = gtVV[float64, *dense.Dense[float64]]{gtOp[float64, *dense.Dense[float64]]{retSame: true}, binopVV{}}
	assert.Equal(op, expected)

	// test vs
	b = dense.New[float64](tensor.WithShape())
	op = Gt[float64, *dense.Dense[float64]](a, b, false)
	expected = gtVS[float64, *dense.Dense[float64]]{gtOp[float64, *dense.Dense[float64]]{retSame: false}, binopVS{}}
	assert.Equal(op, expected)

	// test vs but retSame = true
	op = Gt[float64, *dense.Dense[float64]](a, b, true)
	expected = gtVS[float64, *dense.Dense[float64]]{gtOp[float64, *dense.Dense[float64]]{retSame: true}, binopVS{}}
	assert.Equal(op, expected)

	// test sv
	op = Gt[float64, *dense.Dense[float64]](b, a, false)
	expected = gtSV[float64, *dense.Dense[float64]]{gtOp[float64, *dense.Dense[float64]]{retSame: false}, binopSV{}}
	assert.Equal(op, expected)

	// test sv but retSame = true
	op = Gt[float64, *dense.Dense[float64]](b, a, true)
	expected = gtSV[float64, *dense.Dense[float64]]{gtOp[float64, *dense.Dense[float64]]{retSame: true}, binopSV{}}
	assert.Equal(op, expected)

	// test ss
	a = dense.New[float64](tensor.WithShape())
	op = Gt[float64, *dense.Dense[float64]](a, b, false)
	expected = gtVV[float64, *dense.Dense[float64]]{gtOp[float64, *dense.Dense[float64]]{retSame: false}, binopVV{}}
	assert.Equal(op, expected)

	// test ss but retSame = true
	op = Gt[float64, *dense.Dense[float64]](a, b, true)
	expected = gtVV[float64, *dense.Dense[float64]]{gtOp[float64, *dense.Dense[float64]]{retSame: true}, binopVV{}}
	assert.Equal(op, expected)

}

func TestGte(t *testing.T) {
	assert := assert.New(t)

	var op, expected ops.Op[float64, *dense.Dense[float64]]

	// test vv
	a := dense.New[float64](tensor.WithShape(2, 3))
	b := dense.New[float64](tensor.WithShape(2, 3))
	op = Gte[float64, *dense.Dense[float64]](a, b, false)
	expected = gteVV[float64, *dense.Dense[float64]]{gteOp[float64, *dense.Dense[float64]]{retSame: false}, binopVV{}}
	assert.Equal(op, expected)

	// test vv but retSame = true
	op = Gte[float64, *dense.Dense[float64]](a, b, true)
	expected = gteVV[float64, *dense.Dense[float64]]{gteOp[float64, *dense.Dense[float64]]{retSame: true}, binopVV{}}
	assert.Equal(op, expected)

	// test vs
	b = dense.New[float64](tensor.WithShape())
	op = Gte[float64, *dense.Dense[float64]](a, b, false)
	expected = gteVS[float64, *dense.Dense[float64]]{gteOp[float64, *dense.Dense[float64]]{retSame: false}, binopVS{}}
	assert.Equal(op, expected)

	// test vs but retSame = true
	op = Gte[float64, *dense.Dense[float64]](a, b, true)
	expected = gteVS[float64, *dense.Dense[float64]]{gteOp[float64, *dense.Dense[float64]]{retSame: true}, binopVS{}}
	assert.Equal(op, expected)

	// test sv
	op = Gte[float64, *dense.Dense[float64]](b, a, false)
	expected = gteSV[float64, *dense.Dense[float64]]{gteOp[float64, *dense.Dense[float64]]{retSame: false}, binopSV{}}
	assert.Equal(op, expected)

	// test sv but retSame = true
	op = Gte[float64, *dense.Dense[float64]](b, a, true)
	expected = gteSV[float64, *dense.Dense[float64]]{gteOp[float64, *dense.Dense[float64]]{retSame: true}, binopSV{}}
	assert.Equal(op, expected)

	// test ss
	a = dense.New[float64](tensor.WithShape())
	op = Gte[float64, *dense.Dense[float64]](a, b, false)
	expected = gteVV[float64, *dense.Dense[float64]]{gteOp[float64, *dense.Dense[float64]]{retSame: false}, binopVV{}}
	assert.Equal(op, expected)

	// test ss but retSame = true
	op = Gte[float64, *dense.Dense[float64]](a, b, true)
	expected = gteVV[float64, *dense.Dense[float64]]{gteOp[float64, *dense.Dense[float64]]{retSame: true}, binopVV{}}
	assert.Equal(op, expected)

}

func TestElEq(t *testing.T) {
	assert := assert.New(t)

	var op, expected ops.Op[float64, *dense.Dense[float64]]

	// test vv
	a := dense.New[float64](tensor.WithShape(2, 3))
	b := dense.New[float64](tensor.WithShape(2, 3))
	op = ElEq[float64, *dense.Dense[float64]](a, b, false)
	expected = elEqVV[float64, *dense.Dense[float64]]{elEqOp[float64, *dense.Dense[float64]]{retSame: false}, binopVV{}}
	assert.Equal(op, expected)

	// test vv but retSame = true
	op = ElEq[float64, *dense.Dense[float64]](a, b, true)
	expected = elEqVV[float64, *dense.Dense[float64]]{elEqOp[float64, *dense.Dense[float64]]{retSame: true}, binopVV{}}
	assert.Equal(op, expected)

	// test vs
	b = dense.New[float64](tensor.WithShape())
	op = ElEq[float64, *dense.Dense[float64]](a, b, false)
	expected = elEqVS[float64, *dense.Dense[float64]]{elEqOp[float64, *dense.Dense[float64]]{retSame: false}, binopVS{}}
	assert.Equal(op, expected)

	// test vs but retSame = true
	op = ElEq[float64, *dense.Dense[float64]](a, b, true)
	expected = elEqVS[float64, *dense.Dense[float64]]{elEqOp[float64, *dense.Dense[float64]]{retSame: true}, binopVS{}}
	assert.Equal(op, expected)

	// test sv
	op = ElEq[float64, *dense.Dense[float64]](b, a, false)
	expected = elEqSV[float64, *dense.Dense[float64]]{elEqOp[float64, *dense.Dense[float64]]{retSame: false}, binopSV{}}
	assert.Equal(op, expected)

	// test sv but retSame = true
	op = ElEq[float64, *dense.Dense[float64]](b, a, true)
	expected = elEqSV[float64, *dense.Dense[float64]]{elEqOp[float64, *dense.Dense[float64]]{retSame: true}, binopSV{}}
	assert.Equal(op, expected)

	// test ss
	a = dense.New[float64](tensor.WithShape())
	op = ElEq[float64, *dense.Dense[float64]](a, b, false)
	expected = elEqVV[float64, *dense.Dense[float64]]{elEqOp[float64, *dense.Dense[float64]]{retSame: false}, binopVV{}}
	assert.Equal(op, expected)

	// test ss but retSame = true
	op = ElEq[float64, *dense.Dense[float64]](a, b, true)
	expected = elEqVV[float64, *dense.Dense[float64]]{elEqOp[float64, *dense.Dense[float64]]{retSame: true}, binopVV{}}
	assert.Equal(op, expected)

}

func TestElNe(t *testing.T) {
	assert := assert.New(t)

	var op, expected ops.Op[float64, *dense.Dense[float64]]

	// test vv
	a := dense.New[float64](tensor.WithShape(2, 3))
	b := dense.New[float64](tensor.WithShape(2, 3))
	op = ElNe[float64, *dense.Dense[float64]](a, b, false)
	expected = elNeVV[float64, *dense.Dense[float64]]{elNeOp[float64, *dense.Dense[float64]]{retSame: false}, binopVV{}}
	assert.Equal(op, expected)

	// test vv but retSame = true
	op = ElNe[float64, *dense.Dense[float64]](a, b, true)
	expected = elNeVV[float64, *dense.Dense[float64]]{elNeOp[float64, *dense.Dense[float64]]{retSame: true}, binopVV{}}
	assert.Equal(op, expected)

	// test vs
	b = dense.New[float64](tensor.WithShape())
	op = ElNe[float64, *dense.Dense[float64]](a, b, false)
	expected = elNeVS[float64, *dense.Dense[float64]]{elNeOp[float64, *dense.Dense[float64]]{retSame: false}, binopVS{}}
	assert.Equal(op, expected)

	// test vs but retSame = true
	op = ElNe[float64, *dense.Dense[float64]](a, b, true)
	expected = elNeVS[float64, *dense.Dense[float64]]{elNeOp[float64, *dense.Dense[float64]]{retSame: true}, binopVS{}}
	assert.Equal(op, expected)

	// test sv
	op = ElNe[float64, *dense.Dense[float64]](b, a, false)
	expected = elNeSV[float64, *dense.Dense[float64]]{elNeOp[float64, *dense.Dense[float64]]{retSame: false}, binopSV{}}
	assert.Equal(op, expected)

	// test sv but retSame = true
	op = ElNe[float64, *dense.Dense[float64]](b, a, true)
	expected = elNeSV[float64, *dense.Dense[float64]]{elNeOp[float64, *dense.Dense[float64]]{retSame: true}, binopSV{}}
	assert.Equal(op, expected)

	// test ss
	a = dense.New[float64](tensor.WithShape())
	op = ElNe[float64, *dense.Dense[float64]](a, b, false)
	expected = elNeVV[float64, *dense.Dense[float64]]{elNeOp[float64, *dense.Dense[float64]]{retSame: false}, binopVV{}}
	assert.Equal(op, expected)

	// test ss but retSame = true
	op = ElNe[float64, *dense.Dense[float64]](a, b, true)
	expected = elNeVV[float64, *dense.Dense[float64]]{elNeOp[float64, *dense.Dense[float64]]{retSame: true}, binopVV{}}
	assert.Equal(op, expected)

}
